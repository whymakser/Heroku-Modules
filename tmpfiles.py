# -- version --
__version__ = (1, 0, 0)
# -- version --


# â–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•—â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
# â–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•
# â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘
# â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–‘â–‘â•šâ•â•â•â–ˆâ–ˆâ•—â–‘â•šâ•â•â•â–ˆâ–ˆâ•—
# â–ˆâ–ˆâ•‘â–‘â•šâ•â•â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–‘â–‘â•šâ–ˆâ–ˆâ•”â•â–‘â•šâ–ˆâ–ˆâ•”â•â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
# â•šâ•â•â–‘â–‘â–‘â–‘â–‘â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â–‘â–‘â•šâ•â•â•šâ•â•â•â•â•â•â–‘â–‘â•šâ•â•â•â•â•â–‘â–‘â–‘â–‘â•šâ•â•â–‘â–‘â–‘â•šâ•â•â–‘â–‘â•šâ•â•â•â•â•â•â–‘â•šâ•â•â•â•â•â•â–‘
#                Â© Copyright 2025
#            âœˆ https://t.me/mead0wssMods


# meta developer: @mead0wssMods



# -- main --
from .. import loader, utils
import io
import requests
import json 
# -- main --



@loader.tds
class tmpfilesMod(loader.Module): # initialization 
    """ĞœĞ¾Ğ´ÑƒĞ»ÑŒ Ğ´Ğ»Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ½Ğ° tmpfiles.org"""

    strings = {
        "name": "tmpfiles",
        "uploading": "<emoji document_id=5307779382499090971>ğŸ«¥</emoji> <b>Uploading file...</b>",
        "reply_to_file": "<emoji document_id=4958526153955476488>âŒ</emoji> <b>Reply to file!</b>",
        "uploaded": "<emoji document_id=5278611606756942667>â¤ï¸</emoji> <b>Successful! File uploaded!</b>\n\n<emoji document_id=5278305362703835500>ğŸ”—</emoji> <b>URL:</b> <code>{}</code>",
        "error": "<emoji document_id=4958526153955476488>âŒ</emoji> <b>Error while uploading: {}</b>"
    }
    # ÑÑ‚Ñ€Ğ¸Ğ½Ğ³Ğ¸ (Ğ½Ğµ Ğ¼Ğ¾Ğ¸)
    strings_ru = {
        "name": "tmpfiles", 
        "uploading": "<emoji document_id=5307779382499090971>ğŸ«¥</emoji> <b>Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°Ñ Ñ„Ğ°Ğ¹Ğ»...</b>",
        "reply_to_file": "<emoji document_id=4958526153955476488>âŒ</emoji> <b>ĞÑ‚Ğ²ĞµÑ‚ÑŒÑ‚Ğµ Ğ½Ğ° Ñ„Ğ°Ğ¹Ğ»!</b>", 
        "uploaded": "ï¸<emoji document_id=5278611606756942667>â¤ï¸</emoji> <b>Ğ¤Ğ°Ğ¹Ğ» ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½!</b>\n\n<emoji document_id=5278305362703835500>ğŸ”—</emoji> <b>URL:</b> <code>{}</code>",
        "error": "<emoji document_id=4958526153955476488>âŒ</emoji> <b>ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ: {}</b>"
    }

    async def _get_file(self, message): # helper
        """Helper to get file from message""" 
        reply = await message.get_reply_message()
        if not reply:
            await utils.answer(message, self.strings["reply_to_file"])
            return None
            
        if reply.media:
            file = io.BytesIO(await self.client.download_media(reply.media, bytes))
            if hasattr(reply.media, "document"):
                file.name = reply.file.name or f"file_{reply.file.id}"
            else:
                file.name = f"file_{reply.id}.jpg"
        else:
            file = io.BytesIO(bytes(reply.raw_text, "utf-8"))
            file.name = "text.txt"
            
        return file
        
    @loader.command(
        ru_doc = "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ²Ğ°ÑˆĞ¸Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ½Ğ° tmpfiles.org", #loader
        en_doc = "Uploading your files to tmpfiles.org"
    )
    async def tmpfilescmd(self, message): # upload files
        await utils.answer(message, self.strings["uploading"])
        file = await self._get_file(message)
        if not file:
            return

        try:
            response = requests.post(
                "https://tmpfiles.org/api/v1/upload", # requests 
                files={"file": file}
            )
            if response.ok:
                data = json.loads(response.text)
                url = data["data"]["url"]
                await utils.answer(message, self.strings["uploaded"].format(url))
            else:
                await utils.answer(message, self.strings["error"].format(response.status_code))
        except Exception as e:
            await utils.answer(message, self.strings["error"].format(str(e)))
            
            
            
            
            
# Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ (Ğ´Ğ° Ğ¸ ÑĞ°Ğ¼Ğ° Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°) Ğ²Ğ·ÑÑ‚Ğ° Ñ K:Uploader <3
